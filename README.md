# Vid-to-Thumb

高度な動画フレーム抽出ツールです。指定した動画またはディレクトリ内の動画から、特定のフレームを画像として切り出します。  
フレーム指定はフレーム番号や「t+XhYmZs」の形式で時間を指定でき、指定したフレームをサムネイル化して保存します。
出力ファイル名はデフォルトで```{元ファイル名}_f000000_0.00s.jpg```となります。

## 特徴

- 動画ファイルやディレクトリ単位で一括処理が可能  
- フレーム番号または「t+時間」形式で抽出タイミングを指定  
- カスタムのファイル名パターンの指定や、元ファイル名の利用・正規表現に基づいた変更が可能  
- ファイルが重複する場合は自動でリネームして上書きを防止  
- 日本語のログ／エラーメッセージ表示  

## 必要環境

- Python 3.6 以降  
- OpenCV (cv2)  
- 依存ライブラリ (argparse, os, re, datetime 等、標準ライブラリ中心)

OpenCV が未インストールの場合は、以下のコマンドでインストールしてください:

```
pip install opencv-python
```

## 使い方

### コマンドライン引数

```
python Vid-to-Thumb.py input [options]
```
### デフォルト動作

すべてのオプションを指定しない場合の動作は以下の通りです：

```
python Vid-to-Thumb.py video.mp4
```

- **入力ファイル**: `video.mp4`
- **出力形式**: `jpg`
- **出力ディレクトリ**: `./thumbnails`
- **フレーム指定**: `0`（最初のフレーム）
- **命名規則**: `{元ファイル名}_f{フレーム番号}_{時間位置}`
- **出力ファイル**: `./thumbnails/video_f000000_0.00s.jpg`

### 引数とオプションの一覧

- input  
  - 動画ファイルまたはディレクトリのパスを指定  
- -f, --format  
  - 出力画像形式（例: jpg, png など）  
  - 省略時は「jpg」  
- -o, --output  
  - 出力先ディレクトリ  
  - 省略時は「./thumbnails」  
- -n, --frame  
  - 保存するフレーム番号または t+時間 形式  
  - 数値の場合はそのままフレーム番号、"t+1h30m" のように指定すると該当時間からフレームを抽出  
  - 省略時は 0（最初のフレーム）  
- --name  
  - カスタム命名パターン  
  - "{n}" や "{f}" などの特殊な置換が利用可能（スクリプト内の apply_regex_pattern 関数を参照）  
- --original-name  
  - 元のファイル名をそのまま使用して出力  
  - --name オプションとは併用不可  

### 実行例

1. フレーム番号指定 (5 フレーム目を抽出):  
   ```
   python Vid-to-Thumb.py sample_video.mp4 -n 5
   ```
   - 出力形式はデフォルトの jpg  
   - 出力先は ./thumbnails に保存  

2. 時間指定 (1時間30分後のフレームを抽出)  
   ```
   python Vid-to-Thumb.py sample_video.mp4 -n t+1h30m
   ```
   - "t+時間" によって、フレームを自動計算して抽出  

3. カスタム命名 (フレーム番号や時間を含む命名パターン)  
   ```
   python Vid-to-Thumb.py sample_video.mp4 -n t+5m -f png --name "{n.base}_frame{f}_{t}"
   ```
   - 元動画ファイル名の拡張子を除いた部分にフレーム番号と時間を加え、png 形式で保存  
   - 例: sample_video_frame000075_75.00s.png  

4. ディレクトリ指定 (一括処理)  
   ```
   python Vid-to-Thumb.py ./videos -n 100
   ```
   - 指定ディレクトリ内の動画すべてに対して 100 フレーム目を抽出し、サムネイル画像を出力  

## 補足情報

- スクリプトは OpenCV の VideoCapture を用いて動画を読み込み、指定したフレーム番号へシークして画像を切り出します。  
- ディレクトリ指定を行った場合は、dir 内のファイルから拡張子が (.mp4, .avi, .mov, .mkv, .flv, .wmv) のものを自動的に処理します。  

## ライセンス

本スクリプトのライセンスはリポジトリで指定されているライセンスに従います。詳細はリポジトリの [LICENSE](../LICENSE) をご確認ください。

--------------------------------------------------------------------------------

以上が「Vid-to-Thumb.py」の概要と使用方法です。必要に応じてスクリプトに合わせて修正・追記してご利用ください。  
